<!-- ì‚¬ì´íŠ¸ ê´€ë¦¬ ì»´í¬ë„ŒíŠ¸ -->
<div class="site-management-component">
    <div class="component-header">
        <h4 class="component-title">í¬ë¡¤ë§ ëŒ€ìƒ ì‚¬ì´íŠ¸ ê´€ë¦¬</h4>
        <div class="component-description">
            Excel íŒŒì¼ë¡œ í¬ë¡¤ë§ ëŒ€ìƒ ì‚¬ì´íŠ¸ë¥¼ ì¼ê´„ ë“±ë¡í•˜ê³  ê´€ë¦¬í•©ë‹ˆë‹¤.
        </div>
    </div>

    <!-- Excel íŒŒì¼ ì—…ë¡œë“œ ì˜ì—­ -->
    <div class="file-upload-section">
        <div class="upload-area" id="upload-area">
            <div class="upload-content">
                <div class="upload-icon">ğŸ“</div>
                <div class="upload-text">
                    <div class="upload-title">Excel íŒŒì¼ì„ ë“œë˜ê·¸í•˜ì—¬ ì—…ë¡œë“œ</div>
                    <div class="upload-subtitle">ë˜ëŠ” í´ë¦­í•˜ì—¬ íŒŒì¼ ì„ íƒ</div>
                </div>
                <div class="upload-formats">
                    ì§€ì› í˜•ì‹: .xlsx, .xls (ìµœëŒ€ 10MB)
                </div>
            </div>
            <input type="file" id="site-file-input" accept=".xlsx,.xls" class="file-input" multiple>
        </div>
        
        <!-- ì—…ë¡œë“œ ì§„í–‰ ìƒí™© -->
        <div class="upload-progress hidden" id="upload-progress">
            <div class="progress-header">
                <span class="progress-text">íŒŒì¼ ì—…ë¡œë“œ ì¤‘...</span>
                <span class="progress-percentage">0%</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>
        </div>
    </div>

    <!-- Excel í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ -->
    <div class="template-section">
        <div class="template-info">
            <div class="template-icon">ğŸ“‹</div>
            <div class="template-content">
                <div class="template-title">Excel í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ</div>
                <div class="template-description">
                    ì‚¬ì´íŠ¸ ì •ë³´ë¥¼ ì˜¬ë°”ë¥¸ í˜•ì‹ìœ¼ë¡œ ì‘ì„±í•˜ê¸° ìœ„í•œ í…œí”Œë¦¿ì…ë‹ˆë‹¤.
                </div>
            </div>
            <button class="btn-download-template" onclick="downloadTemplate()">
                <i class="icon">â¬‡ï¸</i>
                í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ
            </button>
        </div>
    </div>

    <!-- ë“±ë¡ëœ ì‚¬ì´íŠ¸ ëª©ë¡ -->
    <div class="sites-section">
        <div class="section-header">
            <div class="section-label">
                <span class="label-text">ë“±ë¡ëœ ì‚¬ì´íŠ¸</span>
                <span class="site-count" id="site-count">0ê°œ</span>
            </div>
            <div class="section-actions">
                <button class="btn-refresh" onclick="refreshSites()" title="ìƒˆë¡œê³ ì¹¨">
                    ğŸ”„
                </button>
                <button class="btn-add-manual" onclick="openAddSiteModal()">
                    â• ìˆ˜ë™ ì¶”ê°€
                </button>
            </div>
        </div>

        <!-- ì‚¬ì´íŠ¸ í•„í„° -->
        <div class="site-filters">
            <div class="filter-group">
                <select class="filter-select" id="type-filter" onchange="filterSites()">
                    <option value="">ëª¨ë“  íƒ€ì…</option>
                    <option value="government">ì •ë¶€ê¸°ê´€</option>
                    <option value="news">ì–¸ë¡ ì‚¬</option>
                    <option value="tech">ê¸°ìˆ ë¸”ë¡œê·¸</option>
                    <option value="research">ì—°êµ¬ê¸°ê´€</option>
                </select>
                <select class="filter-select" id="status-filter" onchange="filterSites()">
                    <option value="">ëª¨ë“  ìƒíƒœ</option>
                    <option value="active">í™œì„±</option>
                    <option value="inactive">ë¹„í™œì„±</option>
                    <option value="error">ì˜¤ë¥˜</option>
                </select>
                <input type="text" class="search-input" id="site-search" placeholder="ì‚¬ì´íŠ¸ëª… ë˜ëŠ” URL ê²€ìƒ‰..." oninput="filterSites()">
            </div>
        </div>

        <!-- ì‚¬ì´íŠ¸ ëª©ë¡ -->
        <div class="sites-list" id="sites-list">
            <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë˜ëŠ” ì‚¬ì´íŠ¸ ì¹´ë“œë“¤ -->
        </div>

        <!-- ë¹ˆ ìƒíƒœ -->
        <div class="empty-state" id="sites-empty-state">
            <div class="empty-icon">ğŸŒ</div>
            <div class="empty-text">ë“±ë¡ëœ ì‚¬ì´íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.</div>
            <div class="empty-subtext">Excel íŒŒì¼ì„ ì—…ë¡œë“œí•˜ê±°ë‚˜ ìˆ˜ë™ìœ¼ë¡œ ì‚¬ì´íŠ¸ë¥¼ ì¶”ê°€í•´ë³´ì„¸ìš”.</div>
        </div>
    </div>
</div>

<!-- ìˆ˜ë™ ì‚¬ì´íŠ¸ ì¶”ê°€ ëª¨ë‹¬ -->
<div class="modal hidden" id="add-site-modal">
    <div class="modal-overlay" onclick="closeAddSiteModal()"></div>
    <div class="modal-content">
        <div class="modal-header">
            <h3 class="modal-title">ì‚¬ì´íŠ¸ ìˆ˜ë™ ì¶”ê°€</h3>
            <button class="modal-close" onclick="closeAddSiteModal()">âœ•</button>
        </div>
        <div class="modal-body">
            <div class="form-group">
                <label class="form-label">ì‚¬ì´íŠ¸ëª… *</label>
                <input type="text" id="manual-site-name" class="form-input" placeholder="ì˜ˆ: í•œêµ­ë°©ì†¡í†µì‹ ìœ„ì›íšŒ">
            </div>
            <div class="form-group">
                <label class="form-label">URL *</label>
                <input type="url" id="manual-site-url" class="form-input" placeholder="https://www.kca.go.kr">
            </div>
            <div class="form-group">
                <label class="form-label">ì‚¬ì´íŠ¸ íƒ€ì…</label>
                <select id="manual-site-type" class="form-select">
                    <option value="government">ì •ë¶€ê¸°ê´€</option>
                    <option value="news">ì–¸ë¡ ì‚¬</option>
                    <option value="tech">ê¸°ìˆ ë¸”ë¡œê·¸</option>
                    <option value="research">ì—°êµ¬ê¸°ê´€</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">ì„¤ëª…</label>
                <textarea id="manual-site-description" class="form-textarea" placeholder="ì‚¬ì´íŠ¸ì— ëŒ€í•œ ê°„ë‹¨í•œ ì„¤ëª…"></textarea>
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn-secondary" onclick="closeAddSiteModal()">ì·¨ì†Œ</button>
            <button class="btn-primary" onclick="addSiteManually()">ì¶”ê°€</button>
        </div>
    </div>
</div>

<style>
/* ì‚¬ì´íŠ¸ ê´€ë¦¬ ì»´í¬ë„ŒíŠ¸ ìŠ¤íƒ€ì¼ */
.site-management-component {
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.08);
    border-radius: 16px;
    padding: 24px;
    margin-bottom: 24px;
}

.component-header {
    margin-bottom: 32px;
}

.component-title {
    color: white;
    font-size: 1.25rem;
    font-weight: 600;
    margin-bottom: 8px;
}

.component-description {
    color: rgb(171, 178, 191);
    font-size: 0.9rem;
}

/* íŒŒì¼ ì—…ë¡œë“œ ì˜ì—­ */
.file-upload-section {
    margin-bottom: 32px;
}

.upload-area {
    border: 2px dashed rgba(198, 120, 221, 0.3);
    border-radius: 12px;
    padding: 40px 20px;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
    background: rgba(198, 120, 221, 0.05);
}

.upload-area:hover {
    border-color: rgba(198, 120, 221, 0.5);
    background: rgba(198, 120, 221, 0.08);
}

.upload-area.dragover {
    border-color: rgb(198, 120, 221);
    background: rgba(198, 120, 221, 0.1);
    transform: scale(1.02);
}

.file-input {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    opacity: 0;
    cursor: pointer;
}

.upload-icon {
    font-size: 3rem;
    margin-bottom: 16px;
}

.upload-title {
    color: white;
    font-size: 1.1rem;
    font-weight: 500;
    margin-bottom: 8px;
}

.upload-subtitle {
    color: rgb(171, 178, 191);
    font-size: 0.9rem;
    margin-bottom: 16px;
}

.upload-formats {
    color: rgb(156, 163, 175);
    font-size: 0.8rem;
}

/* ì—…ë¡œë“œ ì§„í–‰ ìƒí™© */
.upload-progress {
    margin-top: 16px;
    padding: 16px;
    background: rgba(86, 182, 194, 0.1);
    border-radius: 8px;
}

.progress-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
}

.progress-text {
    color: white;
    font-size: 0.9rem;
}

.progress-percentage {
    color: rgb(86, 182, 194);
    font-weight: 500;
}

.progress-bar {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 4px;
    height: 6px;
    overflow: hidden;
}

.progress-fill {
    background: linear-gradient(90deg, rgb(86, 182, 194), rgb(198, 120, 221));
    height: 100%;
    width: 0%;
    transition: width 0.3s ease;
}

/* í…œí”Œë¦¿ ì„¹ì…˜ */
.template-section {
    margin-bottom: 32px;
    padding: 20px;
    background: rgba(229, 192, 123, 0.1);
    border: 1px solid rgba(229, 192, 123, 0.2);
    border-radius: 12px;
}

.template-info {
    display: flex;
    align-items: center;
    gap: 16px;
}

.template-icon {
    font-size: 2rem;
    color: rgb(229, 192, 123);
}

.template-content {
    flex: 1;
}

.template-title {
    color: white;
    font-weight: 500;
    margin-bottom: 4px;
}

.template-description {
    color: rgb(171, 178, 191);
    font-size: 0.9rem;
}

.btn-download-template {
    background: rgb(229, 192, 123);
    color: white;
    border: none;
    border-radius: 8px;
    padding: 10px 16px;
    font-weight: 500;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: all 0.2s ease;
}

.btn-download-template:hover {
    background: rgb(209, 172, 103);
    transform: translateY(-1px);
}

/* ì‚¬ì´íŠ¸ ëª©ë¡ ì„¹ì…˜ */
.sites-section {
    border-top: 1px solid rgba(255, 255, 255, 0.1);
    padding-top: 24px;
}

.section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
}

.section-label {
    display: flex;
    align-items: center;
    gap: 12px;
}

.label-text {
    color: white;
    font-weight: 500;
    font-size: 1.1rem;
}

.site-count {
    color: rgb(171, 178, 191);
    font-size: 0.9rem;
}

.section-actions {
    display: flex;
    gap: 8px;
}

.btn-refresh {
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: rgb(171, 178, 191);
    border-radius: 6px;
    padding: 8px;
    cursor: pointer;
    transition: all 0.2s ease;
}

.btn-refresh:hover {
    background: rgba(255, 255, 255, 0.15);
    color: white;
}

.btn-add-manual {
    background: rgb(86, 182, 194);
    color: white;
    border: none;
    border-radius: 6px;
    padding: 8px 12px;
    font-size: 0.9rem;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease;
}

.btn-add-manual:hover {
    background: rgb(66, 162, 174);
}

/* í•„í„° */
.site-filters {
    margin-bottom: 20px;
}

.filter-group {
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
}

.filter-select, .search-input {
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 6px;
    padding: 8px 12px;
    color: white;
    font-size: 0.9rem;
}

.filter-select {
    min-width: 120px;
}

.search-input {
    flex: 1;
    min-width: 200px;
}

.search-input::placeholder {
    color: rgb(171, 178, 191);
}

/* ì‚¬ì´íŠ¸ ëª©ë¡ */
.sites-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
    gap: 16px;
}

.site-card {
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    padding: 20px;
    transition: all 0.2s ease;
}

.site-card:hover {
    background: rgba(255, 255, 255, 0.08);
    transform: translateY(-2px);
}

.site-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 12px;
}

.site-info {
    flex: 1;
}

.site-name {
    color: white;
    font-weight: 600;
    font-size: 1.1rem;
    margin-bottom: 4px;
}

.site-url {
    color: rgb(86, 182, 194);
    font-size: 0.9rem;
    text-decoration: none;
    word-break: break-all;
}

.site-url:hover {
    text-decoration: underline;
}

.site-status {
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 0.8rem;
    font-weight: 500;
    flex-shrink: 0;
}

.site-status.active {
    background: rgba(152, 195, 121, 0.2);
    color: rgb(152, 195, 121);
}

.site-status.inactive {
    background: rgba(171, 178, 191, 0.2);
    color: rgb(171, 178, 191);
}

.site-status.error {
    background: rgba(224, 108, 117, 0.2);
    color: rgb(224, 108, 117);
}

.site-meta {
    display: flex;
    gap: 16px;
    margin-bottom: 12px;
    font-size: 0.9rem;
    color: rgb(171, 178, 191);
}

.site-type {
    padding: 2px 8px;
    border-radius: 8px;
    font-size: 0.8rem;
}

.site-type.government {
    background: rgba(224, 108, 117, 0.2);
    color: rgb(224, 108, 117);
}

.site-type.news {
    background: rgba(86, 182, 194, 0.2);
    color: rgb(86, 182, 194);
}

.site-type.tech {
    background: rgba(198, 120, 221, 0.2);
    color: rgb(198, 120, 221);
}

.site-type.research {
    background: rgba(229, 192, 123, 0.2);
    color: rgb(229, 192, 123);
}

.site-description {
    color: rgb(171, 178, 191);
    font-size: 0.9rem;
    line-height: 1.4;
    margin-bottom: 16px;
}

.site-actions {
    display: flex;
    gap: 8px;
    justify-content: flex-end;
}

.btn-edit, .btn-delete, .btn-test {
    padding: 6px 12px;
    border-radius: 4px;
    font-size: 0.8rem;
    cursor: pointer;
    transition: all 0.2s ease;
}

.btn-edit {
    background: rgba(229, 192, 123, 0.2);
    border: 1px solid rgba(229, 192, 123, 0.3);
    color: rgb(229, 192, 123);
}

.btn-delete {
    background: rgba(224, 108, 117, 0.2);
    border: 1px solid rgba(224, 108, 117, 0.3);
    color: rgb(224, 108, 117);
}

.btn-test {
    background: rgba(86, 182, 194, 0.2);
    border: 1px solid rgba(86, 182, 194, 0.3);
    color: rgb(86, 182, 194);
}

/* ë¹ˆ ìƒíƒœ */
.empty-state {
    text-align: center;
    padding: 60px 20px;
    color: rgb(171, 178, 191);
}

.empty-state.hidden {
    display: none;
}

.empty-icon {
    font-size: 4rem;
    margin-bottom: 20px;
    opacity: 0.5;
}

.empty-text {
    font-size: 1.2rem;
    font-weight: 500;
    margin-bottom: 8px;
}

.empty-subtext {
    font-size: 0.9rem;
    opacity: 0.8;
}

/* ëª¨ë‹¬ */
.modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1000;
    display: flex;
    align-items: center;
    justify-content: center;
}

.modal.hidden {
    display: none;
}

.modal-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.7);
}

.modal-content {
    background: rgb(31, 35, 40);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    width: 90%;
    max-width: 500px;
    max-height: 80vh;
    overflow-y: auto;
    position: relative;
    z-index: 1;
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 20px 24px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.modal-title {
    color: white;
    font-size: 1.2rem;
    font-weight: 600;
}

.modal-close {
    background: none;
    border: none;
    color: rgb(171, 178, 191);
    font-size: 1.5rem;
    cursor: pointer;
}

.modal-body {
    padding: 24px;
}

.form-group {
    margin-bottom: 20px;
}

.form-label {
    display: block;
    color: white;
    font-weight: 500;
    margin-bottom: 8px;
}

.form-input, .form-select, .form-textarea {
    width: 100%;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 6px;
    padding: 10px 12px;
    color: white;
    font-size: 0.9rem;
}

.form-textarea {
    resize: vertical;
    min-height: 80px;
}

.modal-footer {
    display: flex;
    gap: 12px;
    justify-content: flex-end;
    padding: 20px 24px;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
}

.btn-secondary {
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: rgb(171, 178, 191);
    padding: 10px 20px;
    border-radius: 6px;
    cursor: pointer;
}

.btn-primary {
    background: rgb(198, 120, 221);
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 6px;
    cursor: pointer;
}

/* ìœ í‹¸ë¦¬í‹° */
.hidden {
    display: none !important;
}

/* ë°˜ì‘í˜• */
@media (max-width: 768px) {
    .sites-list {
        grid-template-columns: 1fr;
    }
    
    .filter-group {
        flex-direction: column;
    }
    
    .section-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 12px;
    }
    
    .modal-content {
        width: 95%;
        margin: 20px;
    }
}
</style>

<script>
// ì‚¬ì´íŠ¸ ê´€ë¦¬ ì»´í¬ë„ŒíŠ¸ JavaScript
class SiteManager {
    constructor() {
        this.sites = [];
        this.filteredSites = [];
        this.init();
    }

    init() {
        this.setupFileUpload();
        this.updateDisplay();
        
        // ìƒ˜í”Œ ë°ì´í„° ë¡œë“œ (ì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” API í˜¸ì¶œ)
        this.loadSampleData();
    }

    setupFileUpload() {
        const uploadArea = document.getElementById('upload-area');
        const fileInput = document.getElementById('site-file-input');

        // ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì´ë²¤íŠ¸
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });

        uploadArea.addEventListener('dragleave', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            const files = e.dataTransfer.files;
            this.handleFiles(files);
        });

        // íŒŒì¼ ì„ íƒ ì´ë²¤íŠ¸
        fileInput.addEventListener('change', (e) => {
            this.handleFiles(e.target.files);
        });
    }

    handleFiles(files) {
        for (let file of files) {
            if (this.validateFile(file)) {
                this.uploadFile(file);
            }
        }
    }

    validateFile(file) {
        const validTypes = ['application/vnd.openxmlformats-officedocument.spreadsheetml.sheet', 
                           'application/vnd.ms-excel'];
        const maxSize = 10 * 1024 * 1024; // 10MB

        if (!validTypes.includes(file.type)) {
            this.showMessage('Excel íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.', 'error');
            return false;
        }

        if (file.size > maxSize) {
            this.showMessage('íŒŒì¼ í¬ê¸°ëŠ” 10MB ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.', 'error');
            return false;
        }

        return true;
    }

    async uploadFile(file) {
        const progressDiv = document.getElementById('upload-progress');
        const progressFill = document.getElementById('progress-fill');
        
        progressDiv.classList.remove('hidden');

        try {
            // íŒŒì¼ ì—…ë¡œë“œ ì‹œë®¬ë ˆì´ì…˜
            for (let i = 0; i <= 100; i += 10) {
                await new Promise(resolve => setTimeout(resolve, 100));
                progressFill.style.width = i + '%';
                document.querySelector('.progress-percentage').textContent = i + '%';
            }

            // Excel íŒŒì¼ íŒŒì‹± ì‹œë®¬ë ˆì´ì…˜
            const sites = await this.parseExcelFile(file);
            this.addSites(sites);
            
            this.showMessage(`${sites.length}ê°œì˜ ì‚¬ì´íŠ¸ê°€ ì„±ê³µì ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.`, 'success');
            
        } catch (error) {
            this.showMessage('íŒŒì¼ ì—…ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
        } finally {
            progressDiv.classList.add('hidden');
        }
    }

    async parseExcelFile(file) {
        // ì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” SheetJS ë“±ì„ ì‚¬ìš©í•˜ì—¬ Excel íŒŒì‹±
        // ì—¬ê¸°ì„œëŠ” ìƒ˜í”Œ ë°ì´í„° ë°˜í™˜
        return [
            {
                name: 'í•œêµ­ë°©ì†¡í†µì‹ ìœ„ì›íšŒ',
                url: 'https://www.kca.go.kr',
                type: 'government',
                description: 'ë°©ì†¡í†µì‹  ì •ì±… ë° ê·œì œ ê¸°ê´€',
                status: 'active'
            },
            {
                name: 'ì „ìì‹ ë¬¸',
                url: 'https://www.etnews.com',
                type: 'news',
                description: 'IT ì „ë¬¸ ë‰´ìŠ¤ ë§¤ì²´',
                status: 'active'
            }
        ];
    }

    addSites(sites) {
        sites.forEach(site => {
            const newSite = {
                id: Date.now() + Math.random(),
                ...site,
                createdAt: new Date(),
                lastCrawled: null
            };
            this.sites.push(newSite);
        });
        
        this.updateDisplay();
    }

    filterSites() {
        const typeFilter = document.getElementById('type-filter').value;
        const statusFilter = document.getElementById('status-filter').value;
        const searchTerm = document.getElementById('site-search').value.toLowerCase();

        this.filteredSites = this.sites.filter(site => {
            const matchesType = !typeFilter || site.type === typeFilter;
            const matchesStatus = !statusFilter || site.status === statusFilter;
            const matchesSearch = !searchTerm || 
                site.name.toLowerCase().includes(searchTerm) ||
                site.url.toLowerCase().includes(searchTerm);

            return matchesType && matchesStatus && matchesSearch;
        });

        this.updateDisplay();
    }

    updateDisplay() {
        const container = document.getElementById('sites-list');
        const emptyState = document.getElementById('sites-empty-state');
        const countElement = document.getElementById('site-count');

        const sitesToShow = this.filteredSites.length > 0 ? this.filteredSites : this.sites;
        
        countElement.textContent = `${sitesToShow.length}ê°œ`;

        if (sitesToShow.length === 0) {
            container.style.display = 'none';
            emptyState.classList.remove('hidden');
        } else {
            container.style.display = 'grid';
            emptyState.classList.add('hidden');
            
            container.innerHTML = sitesToShow.map(site => this.createSiteCard(site)).join('');
        }
    }

    createSiteCard(site) {
        const typeNames = {
            government: 'ì •ë¶€ê¸°ê´€',
            news: 'ì–¸ë¡ ì‚¬',
            tech: 'ê¸°ìˆ ë¸”ë¡œê·¸',
            research: 'ì—°êµ¬ê¸°ê´€'
        };

        const statusNames = {
            active: 'í™œì„±',
            inactive: 'ë¹„í™œì„±',
            error: 'ì˜¤ë¥˜'
        };

        return `
            <div class="site-card" data-id="${site.id}">
                <div class="site-header">
                    <div class="site-info">
                        <div class="site-name">${site.name}</div>
                        <a href="${site.url}" target="_blank" class="site-url">${site.url}</a>
                    </div>
                    <div class="site-status ${site.status}">${statusNames[site.status]}</div>
                </div>
                <div class="site-meta">
                    <span class="site-type ${site.type}">${typeNames[site.type]}</span>
                    <span class="site-created">ë“±ë¡: ${new Date(site.createdAt).toLocaleDateString()}</span>
                    ${site.lastCrawled ? `<span class="site-crawled">ìµœê·¼ í¬ë¡¤ë§: ${new Date(site.lastCrawled).toLocaleDateString()}</span>` : ''}
                </div>
                ${site.description ? `<div class="site-description">${site.description}</div>` : ''}
                <div class="site-actions">
                    <button class="btn-test" onclick="testSite(${site.id})">í…ŒìŠ¤íŠ¸</button>
                    <button class="btn-edit" onclick="editSite(${site.id})">ìˆ˜ì •</button>
                    <button class="btn-delete" onclick="deleteSite(${site.id})">ì‚­ì œ</button>
                </div>
            </div>
        `;
    }

    loadSampleData() {
        this.sites = [
            {
                id: 1,
                name: 'í•œêµ­ë°©ì†¡í†µì‹ ìœ„ì›íšŒ',
                url: 'https://www.kca.go.kr',
                type: 'government',
                description: 'ë°©ì†¡í†µì‹  ì •ì±… ë° ê·œì œ ê¸°ê´€',
                status: 'active',
                createdAt: new Date('2024-01-10'),
                lastCrawled: new Date('2024-01-15')
            },
            {
                id: 2,
                name: 'ì „ìì‹ ë¬¸',
                url: 'https://www.etnews.com',
                type: 'news',
                description: 'IT ì „ë¬¸ ë‰´ìŠ¤ ë§¤ì²´',
                status: 'active',
                createdAt: new Date('2024-01-12'),
                lastCrawled: new Date('2024-01-14')
            },
            {
                id: 3,
                name: 'ë„¤ì´ë²„ ë‰´ìŠ¤',
                url: 'https://news.naver.com',
                type: 'news',
                description: 'ì¢…í•© ë‰´ìŠ¤ í¬í„¸',
                status: 'inactive',
                createdAt: new Date('2024-01-08'),
                lastCrawled: null
            }
        ];
        this.updateDisplay();
    }

    showMessage(message, type = 'info') {
        // ë©”ì‹œì§€ í‘œì‹œ (í‚¤ì›Œë“œ ê´€ë¦¬ ì»´í¬ë„ŒíŠ¸ì™€ ë™ì¼)
        const messageDiv = document.createElement('div');
        messageDiv.className = `message message-${type}`;
        messageDiv.textContent = message;
        messageDiv.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            background: ${type === 'success' ? 'rgb(152, 195, 121)' : 
                        type === 'error' ? 'rgb(224, 108, 117)' : 
                        type === 'warning' ? 'rgb(229, 192, 123)' : 'rgb(86, 182, 194)'};
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            z-index: 1000;
            animation: slideInRight 0.3s ease;
        `;
        
        document.body.appendChild(messageDiv);
        
        setTimeout(() => {
            messageDiv.remove();
        }, 3000);
    }
}

// ì „ì—­ ì¸ìŠ¤í„´ìŠ¤
let siteManager;

// ì™¸ë¶€ í•¨ìˆ˜ë“¤
function downloadTemplate() {
    // Excel í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ êµ¬í˜„
    const link = document.createElement('a');
    link.href = '/static/templates/site-template.xlsx';
    link.download = 'ì‚¬ì´íŠ¸_ë“±ë¡_í…œí”Œë¦¿.xlsx';
    link.click();
}

function refreshSites() {
    if (siteManager) {
        siteManager.loadSampleData();
        siteManager.showMessage('ì‚¬ì´íŠ¸ ëª©ë¡ì´ ìƒˆë¡œê³ ì¹¨ë˜ì—ˆìŠµë‹ˆë‹¤.', 'info');
    }
}

function filterSites() {
    if (siteManager) {
        siteManager.filterSites();
    }
}

function openAddSiteModal() {
    document.getElementById('add-site-modal').classList.remove('hidden');
}

function closeAddSiteModal() {
    document.getElementById('add-site-modal').classList.add('hidden');
    // í¼ ì´ˆê¸°í™”
    document.getElementById('manual-site-name').value = '';
    document.getElementById('manual-site-url').value = '';
    document.getElementById('manual-site-type').value = 'government';
    document.getElementById('manual-site-description').value = '';
}

function addSiteManually() {
    const name = document.getElementById('manual-site-name').value.trim();
    const url = document.getElementById('manual-site-url').value.trim();
    const type = document.getElementById('manual-site-type').value;
    const description = document.getElementById('manual-site-description').value.trim();

    if (!name || !url) {
        siteManager.showMessage('ì‚¬ì´íŠ¸ëª…ê³¼ URLì€ í•„ìˆ˜ ì…ë ¥ í•­ëª©ì…ë‹ˆë‹¤.', 'error');
        return;
    }

    const newSite = {
        name,
        url,
        type,
        description,
        status: 'active'
    };

    siteManager.addSites([newSite]);
    closeAddSiteModal();
    siteManager.showMessage('ì‚¬ì´íŠ¸ê°€ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
}

function testSite(siteId) {
    const site = siteManager.sites.find(s => s.id === siteId);
    if (site) {
        siteManager.showMessage(`${site.name} ì‚¬ì´íŠ¸ ì—°ê²°ì„ í…ŒìŠ¤íŠ¸ ì¤‘...`, 'info');
        // ì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” ì‚¬ì´íŠ¸ ì—°ê²° í…ŒìŠ¤íŠ¸ API í˜¸ì¶œ
    }
}

function editSite(siteId) {
    // ì‚¬ì´íŠ¸ ìˆ˜ì • ëª¨ë‹¬ ì—´ê¸° (êµ¬í˜„ í•„ìš”)
    console.log('Edit site:', siteId);
}

function deleteSite(siteId) {
    if (confirm('ì •ë§ë¡œ ì´ ì‚¬ì´íŠ¸ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        siteManager.sites = siteManager.sites.filter(s => s.id !== siteId);
        siteManager.updateDisplay();
        siteManager.showMessage('ì‚¬ì´íŠ¸ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.', 'info');
    }
}

// ì´ˆê¸°í™”
function initSiteManagement() {
    siteManager = new SiteManager();
}

// í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
document.addEventListener('DOMContentLoaded', function() {
    if (typeof siteManager === 'undefined') {
        initSiteManagement();
    }
});
</script>
