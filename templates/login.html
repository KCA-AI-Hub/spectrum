{% extends "base.html" %}

{% block title %}ì „íŒŒ ë™í–¥ì¡°ì‚¬ ë¸Œë¦¬í•‘ - ë¡œê·¸ì¸{% endblock %}

{% block content %}
<div class="min-h-screen flex items-center justify-center px-4">
    <div class="login-container">
        <div class="logo-section text-center mb-10">
            <span class="text-6xl block mb-5">ğŸ“¡</span>
            <h1 class="text-4xl font-semibold text-white mb-3">ì „íŒŒ ë™í–¥ì¡°ì‚¬ ë¸Œë¦¬í•‘</h1>
            <p class="text-muted text-lg">íšŒì‚¬ ì‚¬ë²ˆìœ¼ë¡œ ë¡œê·¸ì¸í•˜ì—¬<br>ì „íŒŒ ê¸°ìˆ  ë™í–¥ì„ í•™ìŠµí•˜ì„¸ìš”</p>
        </div>

        <form class="space-y-6" id="loginForm">
            <div>
                <label for="employeeId" class="block text-sm font-medium text-white mb-2">ì‚¬ë²ˆ</label>
                <input 
                    type="text" 
                    id="employeeId" 
                    name="employee_id"
                    class="w-full px-5 py-4 rounded-xl bg-white/5 border border-white/10 text-white placeholder-muted focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 transition-all"
                    placeholder="ì‚¬ë²ˆì„ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: 2024001)"
                    maxlength="10"
                    required
                >
                <div class="error-message text-danger text-sm mt-2 hidden">ì˜¬ë°”ë¥¸ ì‚¬ë²ˆ í˜•ì‹ì„ ì…ë ¥í•´ì£¼ì„¸ìš”</div>
            </div>

            <div>
                <label for="password" class="block text-sm font-medium text-white mb-2">ë¹„ë°€ë²ˆí˜¸</label>
                <input 
                    type="password" 
                    id="password" 
                    name="password"
                    class="w-full px-5 py-4 rounded-xl bg-white/5 border border-white/10 text-white placeholder-muted focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 transition-all"
                    placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”"
                    required
                >
                <div class="error-message text-danger text-sm mt-2 hidden">ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”</div>
            </div>

            <button type="submit" class="w-full bg-primary text-white py-4 rounded-xl font-semibold text-lg hover:bg-accent transform hover:-translate-y-0.5 transition-all shadow-lg hover:shadow-xl" id="loginBtn">
                <span class="flex items-center justify-center">
                    ë¡œê·¸ì¸
                    <span class="loading hidden ml-3">
                        <svg class="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                        </svg>
                    </span>
                </span>
            </button>
        </form>

        <div class="text-center mt-6">
            <a href="#" class="text-primary hover:text-accent transition-colors" onclick="showForgotPassword()">ë¹„ë°€ë²ˆí˜¸ë¥¼ ìŠìœ¼ì…¨ë‚˜ìš”?</a>
        </div>

        <div class="demo-login mt-8 pt-8 border-t border-white/10">
            <p class="text-muted text-center mb-4">ë°ëª¨ ë²„ì „ìœ¼ë¡œ ì²´í—˜í•´ë³´ê¸°</p>
            <button class="w-full bg-success/20 text-success border border-success/30 py-3 rounded-xl font-medium hover:bg-success/30 transition-all" onclick="demoLogin()">
                ë°ëª¨ ë¡œê·¸ì¸
            </button>
        </div>
    </div>
</div>

<style>
    .login-container {
        background: rgba(255, 255, 255, 0.03);
        border: 1px solid rgba(255, 255, 255, 0.08);
        border-radius: 20px;
        padding: 50px;
        backdrop-filter: blur(20px);
        box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3);
        width: 100%;
        max-width: 450px;
    }
    
    .error-message.show {
        display: block !important;
    }
    
    .loading.show {
        display: inline-block !important;
    }
    
    input.error {
        border-color: rgb(224, 108, 117) !important;
        background: rgba(224, 108, 117, 0.1) !important;
    }
</style>

<script>
    // ë¡œê·¸ì¸ í¼ ì²˜ë¦¬
    document.getElementById('loginForm').addEventListener('submit', function(e) {
        e.preventDefault();
        handleLogin();
    });

    // ë¡œê·¸ì¸ ì²˜ë¦¬
    function handleLogin() {
        const employeeId = document.getElementById('employeeId').value;
        const password = document.getElementById('password').value;
        
        // ë¡œë”© ìƒíƒœ í‘œì‹œ
        const loginBtn = document.getElementById('loginBtn');
        const loading = loginBtn.querySelector('.loading');
        loginBtn.disabled = true;
        loading.classList.add('show');
        
        // ì„œë²„ë¡œ ë¡œê·¸ì¸ ìš”ì²­
        fetch('/login', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded',
            },
            body: `employee_id=${encodeURIComponent(employeeId)}&password=${encodeURIComponent(password)}`
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                window.location.href = '/dashboard';
            } else {
                alert(data.message || 'ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                loginBtn.disabled = false;
                loading.classList.remove('show');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('ë¡œê·¸ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            loginBtn.disabled = false;
            loading.classList.remove('show');
        });
    }

    // ë°ëª¨ ë¡œê·¸ì¸
    function demoLogin() {
        document.getElementById('employeeId').value = '2024001';
        document.getElementById('password').value = 'password';
        handleLogin();
    }

    // ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°
    function showForgotPassword() {
        alert('ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°ëŠ” ì‹œìŠ¤í…œ ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•˜ì„¸ìš”.\n\nì—°ë½ì²˜: admin@company.com\nì „í™”: 02-1234-5678');
    }
</script>
{% endblock %}